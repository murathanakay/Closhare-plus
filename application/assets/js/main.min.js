
$(function(){$(".btn").button();$(".button-loading").click(function(){$(this).button("loading")});$html=$spintarget=$("html");$page=$("#page");$indicatorEl=$page.find("#mainIndicator");$spintarget=$("#pgloader").show();$body=$("body");$container=$("#container");$wrap=$("#wrap");$footer=$("#footer");$viewPort=$("#viewport");$list=$viewPort.find(".directoryList");$sidebar=$("#sidebar");$sideBarStaticTree=$sidebar.find("#sideBarStaticTree");$sdivider=$("#sidebarDivider");$sopener=$("#sidebarOpener");$dirTree=$("#dirTree");$filesSideBarTbar=$("#filesdropdown");$topActBtns=$("#topActionButtons");$itemPaste=$topActBtns.find("#itemPaste");$totalItemsNum=$topActBtns.find("#totalItemsNumber");$dirNav=$topActBtns.find("#dirNav");$uiactControl=$topActBtns.find("#uiactControl");$notify=$("#notify_block");$notifyarea=$(".notify_area");$searcher=$topActBtns.find("#searcher");$norequestArr=new Array("login","register","recover");scrloaded=new Array("noscr");selectedItems={};cutcopyItems=[];lookfor=false;$divider='<div class="divider"/>';$indicatorbg='<i class="loading loading-sm"></i>';$downloadTip='<i class="icon icon-download"></i>';indicatorCss='<div class="indicator"><span></span><span></span><span></span></div>';$.fn.editableform.loading=indicatorCssBlue='<div class="indicator blue"><span></span><span></span><span></span></div>';dir={id:1,name:"Document Root",description:"Document Root",path:"/",parentid:0,parentname:null,files:0,subdirs:"",size:0,page:1};uSt={};succload=false;currPage="list";currDir=1;forceUpdate=true;sortUpdate=false;firstLoad=true;loadMore=false;orderby="type";sortby="desc";$screl=(isMob()&&$(window).width()<481)?$(window):$("#list");mediaPlaying=false;touchable=("ontouchstart" in document.documentElement)?true:false;$indicatorEl.css("visibility","visible");$.jGrowl.defaults.closer=false;$.jGrowl.defaults.closeDuration=1;$.jGrowl.defaults.openDuration=1;$.jGrowl.defaults.pool=1;$(document).ajaxComplete(function(a,i,d){var f=i.getResponseHeader("content-type");if(d.dataType=="json"||f.indexOf("json")>-1){var e=$.parseJSON(i.responseText)||0;if(e&&(e.auth==0||e.auth==2)){$(".modal").modal("hide");$html.blockit({message:e.message,blockMsgClass:"callout callout-danger",button:false,fadeOut:900,overlayCSS:{opacity:0.9}});setTimeout(function(){$("#countrd").countdown(4,"s",function(){fullreload()},true)},150)}if(e.message){var h="check";var c={life:8000};var g="";if(e.message.title||e.title){c.header=e.title||e.message.title}if(e.message.options){c=$.extend(true,c,e.message.options)}if(e.result!==undefined){c.open=function(k,j,l){if(e.result==0){k.addClass("bg-error")}else{if(e.result==2){k.addClass("bg-warning")}}}}if(e.message.icon){c.theme="iconup";h=e.message.icon;g='<div class="icon icon-'+h+'"></div>'}if(e.message.txt&&!$body.hasClass("modal-open")){setTimeout(function(){if(e.message.txt){setTimeout(function(){$notify.jGrowl("close").jGrowl(g+e.message.txt,c)},120)}},30)}if($body.hasClass("modal-open")&&$body.find("#uinotify").length>0){var b=e.message.txt||e.message;$body.find("#uinotify").jGrowl("close").jGrowl(g+b,c)}}checkforAlert(e);$viewPort.unblock();if(e.callback){$.globalEval(e.callback)}succload=(e.result==1)?true:false}})});jQuery(document).ready(function(){viewport();$(window).resize($.throttle(100,function(){viewport.call();sidebar.call()}));window.addEventListener("orientationchange",function(){$(window).resize()},false)});jQuery(function(){var a=("ontouchstart" in document.documentElement?"touchstart":"click");$wrap.on("click",".rpsve",folderInteract);$(document).on("click","a.pg",function(f){f.preventDefault();var d=$(this);d.tab("show");var c={},g="page",b=d.prop("href").replace(/^#/,"");c[g]=b;$.bbq.pushState(c,2)});$(window).bind("hashchange",function(g){$('[data-toggle="dropdown"]').parent().removeClass("open");var c=$.bbq.getState("dir",true)||0,b=$.bbq.getState("filter",true)||0,k=$.bbq.getState("search",true)||0;if(!c){$list.empty();$.bbq.pushState({dir:UIDIR},2)}var d=$sideBarStaticTree.find("button.resetFilter");if(b){if(!(b in filterTypes)){$.bbq.pushState({dir:dir.hash,filter:"image"})}else{if($viewPort.data("filter")!=b){$("#sidebarTabContainer a").last().tab("show")}toggleStaticFilterButtonStates($sideBarStaticTree.find('[rel="#'+b+'"]'))}$sidebar.addClass("filter");d.show();d.disabletoggle(false)}else{$("#sidebarTabContainer a").first().tab("show");$sidebar.removeClass("filter");d.hide();d.disabletoggle(true)}var j=$.bbq.getState(),h,f,i=hash={};$.each(j,function(e,l){if(l){hash[e]=l}});currPage=$.bbq.getState("page",true)||0;currDir=$.bbq.getState("dir",true)?$.bbq.getState("dir",true):((dir.hash)?dir.hash:UIDIR);currFilter=b;currSearch=k;if(c){doPageLoad(h,i)}});$(window).trigger("hashchange");if(firstLoad){$body.removeClass("onload").blockit({message:indicatorCssSm+" Loading...Please wait",simple:true,button:false,fadeOut:900,overlayCSS:{opacity:0.9}})}});function folderInteract(){var d=$(this),b={},e="dir",a=d.data("hash");b[e]=a;var c=currSearch?2:false;$.bbq.pushState(b,c)}function doPageLoad(a,g,b,h){var f=a?a:$("#list"),c={page:"list",dir:UIDIR,order:orderby,sort:sortby,deep:$("#filter_current_dir").is(":checked")},e=firstLoad?1800:300,d=firstLoad?$body:$viewPort;c=$.extend(true,c,g);if(forceUpdate){c.force=true}$.ajaxQueue({url:AJAX_PATH,type:"POST",data:c,cache:true,dataType:"json",beforeSend:function(){if(b){b.blockit({message:$indicator,simple:true,button:true,css:{top:"0"}})}else{if(!firstLoad){d.blockit({message:null,fadeOut:500,overlayCSS:{opacity:0.3}});$indicatorEl.css("visibility","visible")}}},success:function(j){setTimeout(function(){$indicatorEl.css("visibility","hidden");d.unblock()},e);if(j.dir!==undefined){var k=j.dir;$.each(k,function(l,m){if(m!==undefined){dir[l]=m}});dir.itemTotal=parseInt(dir.files+dir.subdirs.count_total);if(!(dir.id in selectedItems)){selectedItems[dir.id]=[]}currDirID=dir.id}if(j.result===1){setTimeout(function(){$.renderListPage(j,f);renderSideBar(j,(j.folderTree!==undefined?true:false));viewport();sidebar();if(h){window[h]()}},17)}var i=jQuery.Event("click");i.target=$wrap.find(".rpsve");if(j.run){$.globalEval(j.run)}}})}function executer(a){$.each(a.acall,function(b,c){if("object"==typeof c||"string"==typeof c){if(c.back==="fn"){setTimeout(function(){$.globalEval(c.run)},150)}else{window[c.back](a.acall[b])}}})}function viewport(){var b=parseInt($(window).height()),e=(parseInt($topActBtns.outerHeight())),d=110,a=0;var c=(e+d);if(c>e+a){c=e+a}headHeight=e;var g=(b-e-a);$viewPort.height(g-2);var f=$("#usageStatistics").is(":hidden")?55:177;$sidebar.find(".tab-pane").height(b-c-f-30);$viewPort.removeClass("view_port_fixed");topBar()};